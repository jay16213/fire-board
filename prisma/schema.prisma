// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Stock {
  id           Int    @id @default(autoincrement())
  stockId      String @unique
  stockName    String
  industryType String
  type         String // '一般', 'ETF' TODO: use enum
}

model StockAccount {
  id               Int                @id @default(autoincrement())
  name             String             @unique
  minFee           Int
  regularFee       Int
  feeDiscount      Decimal
  StockPosition    StockPosition[]
  StockTransaction StockTransaction[]
}

model StockPosition {
  id             Int          @id @default(autoincrement())
  account        StockAccount @relation(fields: [stockAccountId], references: [id])
  stockAccountId Int
  stockId        String       @unique
  stockName      String
  shares         Int
  avgCost        Decimal
  cost           Int
  balancePrice   Decimal
}

model StockTransaction {
  id               Int          @id @default(autoincrement())
  date             DateTime
  account          StockAccount @relation(fields: [stockAccountId], references: [id])
  stockAccountId   Int
  stockId          String
  stockName        String
  type             String // '一般', 'ETF', '定期定額'
  category         String // '買', '賣'
  shares           Int
  price            Decimal
  amount           Int
  fee              Int
  feeAfterDiscount Int
  transactionTax   Int
  transactionCost  Int
  actualPayment    Int
  bookPayment      Int
}
